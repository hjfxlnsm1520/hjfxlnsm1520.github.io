<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>åæ‡‰éŒ¯èª¤éŠæˆ²ãƒ»æƒ¡æ„ç‰ˆ</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin-top: 60px;
      transition: background-color 0.3s;
    }
    h1 {
      font-size: 36px;
    }
    #instruction {
      font-size: 28px;
      margin: 30px;
      min-height: 40px;
    }
    button {
      padding: 15px 35px;
      font-size: 22px;
      cursor: pointer;
      border-radius: 10px;
      border: none;
      background-color: #4CAF50;
      color: white;
    }
    button:active {
      transform: scale(0.95);
    }
    #score {
      margin-top: 30px;
      font-size: 22px;
    }
    #hint {
      margin-top: 15px;
      font-size: 16px;
      color: gray;
    }
  </style>
</head>
<body>

  <h1>ğŸ˜ˆ åæ‡‰éŒ¯èª¤éŠæˆ²</h1>
  <div id="instruction">æº–å‚™ä¸­...</div>

  <button onclick="playerClick()">æŒ‰æˆ‘</button>

  <div id="score">åˆ†æ•¸ï¼š0</div>
  <div id="hint">æœ‰äº›æŒ‡ä»¤æ˜¯é¨™äººçš„</div>

  <script>
    const instructions = [
      { text: "è«‹æŒ‰æŒ‰éˆ•", type: "click" },
      { text: "ä¸è¦æŒ‰æŒ‰éˆ•ï¼ˆç­‰ 2 ç§’ï¼‰", type: "wait" },
      { text: "ä¸‰ç§’å¾Œå†æŒ‰", type: "delay" },

      // ğŸ˜ˆ å£å¿ƒçœ¼æŒ‡ä»¤
      { text: "3ã€2ã€1â€¦ç¾åœ¨ä¸è¦æŒ‰", type: "fake" },
      { text: "ä¸è¦æŒ‰æŒ‰éˆ•ï¼ˆé€™é¡Œæœƒé¨™äººï¼‰", type: "trick" },
      { text: "âš  ä¸‹ä¸€é¡Œè¦å‰‡ç›¸å", type: "reverse" }
    ];

    let score = 0;
    let current = null;
    let canClick = false;
    let roundActive = false;
    let waitTimer = null;
    let reversed = false;

    function updateUI(text) {
      document.getElementById("instruction").textContent = text;
      document.getElementById("score").textContent = "åˆ†æ•¸ï¼š" + score;
    }

    function newRound() {
      if (waitTimer) {
        clearTimeout(waitTimer);
        waitTimer = null;
      }

      roundActive = true;
      canClick = false;

      current = instructions[Math.floor(Math.random() * instructions.length)];
      updateUI(current.text);

      // è¦å‰‡åè½‰
      if (current.type === "reverse") {
        reversed = !reversed;
        document.body.style.backgroundColor = "#FFF3CD";
        roundActive = false;
        setTimeout(() => {
          document.body.style.backgroundColor = "white";
          newRound();
        }, 1000);
        return;
      }

      document.body.style.backgroundColor = "white";

      if (current.type === "click") {
        canClick = !reversed;
      }

      if (current.type === "delay") {
        setTimeout(() => {
          if (roundActive) canClick = !reversed;
        }, 3000);
      }

      if (current.type === "wait") {
        waitTimer = setTimeout(() => {
          if (!roundActive) return;
          score += reversed ? -1 : 1;
          roundActive = false;
          updateUI(reversed ? "âŒ è¢«åè½‰é¨™äº†" : "âœ” å¿ä½äº†ï¼");
          setTimeout(newRound, 800);
        }, 2000);
      }

      if (current.type === "fake" || current.type === "trick") {
        waitTimer = setTimeout(() => {
          if (!roundActive) return;
          score++;
          roundActive = false;
          updateUI("âœ” ä½ æ²’ä¸Šç•¶");
          setTimeout(newRound, 800);
        }, 1500);
      }
    }

    function playerClick() {
      if (!roundActive) return;

      let correct = canClick;
      if (reversed) correct = !correct;

      if (correct) {
        score++;
        updateUI("âœ” æ­£ç¢º");
      } else {
        score--;
        updateUI("âœ– ä¸Šç•¶äº†");
      }

      roundActive = false;
      setTimeout(newRound, 800);
    }

    newRound();
  </script>

</body>
</html>
